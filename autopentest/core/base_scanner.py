"""
Base Scanner module - abstract base class for all scanners
"""
from abc import ABC, abstractmethod
from typing import Dict, Any, List, Optional
import logging


class BaseScanner(ABC):
    """
    扫描器基类，所有扫描器都应继承此类
    """

    def __init__(self, target: str, requester, poc_recorder, logger=None):
        """
        初始化扫描器

        Args:
            target: 目标域名或 URL
            requester: Requester 实例
            poc_recorder: PoCRecorder 实例
            logger: 日志记录器
        """
        self.target = target
        self.requester = requester
        self.poc_recorder = poc_recorder
        self.logger = logger or logging.getLogger(__name__)

        self.results = []
        self.scanned = False

    @abstractmethod
    def scan(self) -> List[Dict[str, Any]]:
        """
        执行扫描，由子类实现具体的扫描逻辑

        Returns:
            扫描结果列表
        """
        pass

    def get_results(self) -> List[Dict[str, Any]]:
        """获取扫描结果"""
        return self.results

    def log_info(self, message: str):
        """记录信息日志"""
        self.logger.info(f"[{self.__class__.__name__}] {message}")

    def log_warning(self, message: str):
        """记录警告日志"""
        self.logger.warning(f"[{self.__class__.__name__}] {message}")

    def log_error(self, message: str):
        """记录错误日志"""
        self.logger.error(f"[{self.__class__.__name__}] {message}")

    def log_success(self, message: str):
        """记录成功日志"""
        self.logger.info(f"[{self.__class__.__name__}] [SUCCESS] {message}")
