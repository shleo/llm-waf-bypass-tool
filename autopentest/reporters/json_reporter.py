"""
JSON Reporter - JSON 格式报告生成器
"""
import json
from typing import Dict, Any
from .base_reporter import BaseReporter


class JSONReporter(BaseReporter):
    """
    JSON 格式报告生成器
    """

    def generate(self, output_path: str, target: str,
                metadata: Dict[str, Any] = None):
        """
        生成 JSON 格式报告

        Args:
            output_path: 输出文件路径
            target: 目标信息
            metadata: 额外的元数据
        """
        report_data = self._get_report_data(target, metadata)

        # 计算风险分数
        risk_score = self._calculate_risk_score(report_data['statistics'])
        report_data['risk_score'] = risk_score
        report_data['risk_level'] = self._get_risk_level(risk_score)

        # 写入文件
        with open(output_path, 'w', encoding='utf-8') as f:
            json.dump(report_data, f, indent=2, ensure_ascii=False)

        return report_data
